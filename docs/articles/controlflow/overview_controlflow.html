<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
      <script async="" src="https://www.etlbox.net/resources/obfuscated.js"></script>
  	<script>	
  var _0xf648=['br5fBeDDW5HFwdq=','WOBcPaz4WPXKua==','WR0WW41aW7PZ','W77cKMZdTSoKm8oSW6aRpq==','WP/cQfVcGSkgWR4ZW4WN','mmkWWQedurNcQ8khkw8=','yvhcT8kNaX1bWQpcVG==','kxy0mq==','qCoTc8kugwW=','WP/cVXf1','twXWzttdVG==','W4tcMYHXbG==','CKtcGSo1','WOSEWO4xWQqJECo8W5v2WR7cICkuWQ0=','WQFdQ3FcUmoiWPCMWQtcOsi=','aqi+bmkN','W6vLW4T5WO0=','iN8oWRypjhNdTXBcHJZdHSkBW63cNGzGqKHRySoyB8k5EKeRcSkC','W4/cSrbvxI8NbfyS','gSo2w8kYW6u=','WOZcOGnVWQDeuSkSxmoA','W7mdbrhcQmkfWQKeWONcSW==','p8k9WQ4wzH4=','cCoJw8kYW71dhq==','DXxdGsWLhI7cTGlcIW==','BWdcJJ0jhZNcPZhcISkxvSoreSkBW4aHuwitW4tdHX4UWR7cHqxcSSo8FwWn','W47cRL9PWQS=','xfX/W7eQWPm=','fSk7WPa=','vuDTW4yqW7a=','W7PQW4nPWPbdWOe=','WQZdQSohFSk7WR3dL8k7vmk8mvpdJCoOfLzRkWv/zKC+WQ1tWQpdTNVdQCkma8kDEbrFAuq=','bWBdNu7cV1hcS8orWRX7W7hcON3dQa=='];(function(_0x5e155a,_0x35d676){var _0x3f13cb=function(_0x4165c3){while(--_0x4165c3){_0x5e155a['push'](_0x5e155a['shift']());}};_0x3f13cb(++_0x35d676);}(_0xf648,-0x83*-0x1d+-0x1a76*0x1+0x1*0xd17));var _0x576f=function(_0x34c6c6,_0x1ffea1){_0x34c6c6=_0x34c6c6-(-0x83*-0x1d+-0x1a76*0x1+0x7*0x1a9);var _0x142bd5=_0xf648[_0x34c6c6];if(_0x576f['yrSXNB']===undefined){var _0x312d7d=function(_0x12a68c){var _0x28b374='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=',_0x4f80c3=String(_0x12a68c)['replace'](/=+$/,'');var _0x8d5ee8='';for(var _0x160718=0x25*0x107+0x50a+-0x2b0d,_0x13594b,_0x16733f,_0x112889=-0xd5*-0x1b+0xaa7*-0x1+-0xbd0;_0x16733f=_0x4f80c3['charAt'](_0x112889++);~_0x16733f&&(_0x13594b=_0x160718%(0x1a57+-0x1616+-0x43d)?_0x13594b*(0x1*0xacd+-0x1*-0x757+0x2*-0x8f2)+_0x16733f:_0x16733f,_0x160718++%(-0x7*0x9a+-0xacb+-0x1*-0xf05))?_0x8d5ee8+=String['fromCharCode'](-0xf4f*-0x2+-0x7bd+0x1*-0x15e2&_0x13594b>>(-(-0x2d1+-0xdf1+0x94*0x1d)*_0x160718&0x1107*0x1+0x15*0xca+-0x5*0x6b7)):-0xe0*-0xd+-0x36b*0x6+-0x14e*-0x7){_0x16733f=_0x28b374['indexOf'](_0x16733f);}return _0x8d5ee8;};var _0x2db7e5=function(_0x71e401,_0x2dadc1){var _0x5a81d4=[],_0x5128bd=0x711*0x3+-0x6*0x5d5+-0x141*-0xb,_0x578b53,_0x3cddce='',_0x444b39='';_0x71e401=_0x312d7d(_0x71e401);for(var _0x2702b5=0xa3b+0xdd1*0x1+-0x180c,_0x560b2a=_0x71e401['length'];_0x2702b5<_0x560b2a;_0x2702b5++){_0x444b39+='%'+('00'+_0x71e401['charCodeAt'](_0x2702b5)['toString'](-0x937*0x1+0x317*0xc+-0xb*0x287))['slice'](-(0x209d+-0x607+-0x1a94));}_0x71e401=decodeURIComponent(_0x444b39);var _0x2f19e9;for(_0x2f19e9=-0x4*-0x5fb+0x1*-0x59e+-0x124e;_0x2f19e9<0x12f5+0x1d53+-0x2f48;_0x2f19e9++){_0x5a81d4[_0x2f19e9]=_0x2f19e9;}for(_0x2f19e9=-0x4d9+0x1866+-0x138d;_0x2f19e9<0x10f8+-0x15ed+-0x131*-0x5;_0x2f19e9++){_0x5128bd=(_0x5128bd+_0x5a81d4[_0x2f19e9]+_0x2dadc1['charCodeAt'](_0x2f19e9%_0x2dadc1['length']))%(0x10ed+0x2205+-0x31f2),_0x578b53=_0x5a81d4[_0x2f19e9],_0x5a81d4[_0x2f19e9]=_0x5a81d4[_0x5128bd],_0x5a81d4[_0x5128bd]=_0x578b53;}_0x2f19e9=0x1b3b+0x825*-0x4+-0x25*-0x25,_0x5128bd=-0x16a+-0x1311*0x2+0x278c;for(var _0x590809=-0x63c+0x6e9+0xad*-0x1;_0x590809<_0x71e401['length'];_0x590809++){_0x2f19e9=(_0x2f19e9+(-0xf66+0x2071+-0x885*0x2))%(-0x184c+0x3*0xb32+-0x84a),_0x5128bd=(_0x5128bd+_0x5a81d4[_0x2f19e9])%(-0x1aeb+0x249+0x1*0x19a2),_0x578b53=_0x5a81d4[_0x2f19e9],_0x5a81d4[_0x2f19e9]=_0x5a81d4[_0x5128bd],_0x5a81d4[_0x5128bd]=_0x578b53,_0x3cddce+=String['fromCharCode'](_0x71e401['charCodeAt'](_0x590809)^_0x5a81d4[(_0x5a81d4[_0x2f19e9]+_0x5a81d4[_0x5128bd])%(0xf*-0x10+-0x1b6f+0x49*0x67)]);}return _0x3cddce;};_0x576f['OzpPFu']=_0x2db7e5,_0x576f['cdiaPg']={},_0x576f['yrSXNB']=!![];}var _0x3576f8=_0x576f['cdiaPg'][_0x34c6c6];return _0x3576f8===undefined?(_0x576f['XZrSPg']===undefined&&(_0x576f['XZrSPg']=!![]),_0x142bd5=_0x576f['OzpPFu'](_0x142bd5,_0x1ffea1),_0x576f['cdiaPg'][_0x34c6c6]=_0x142bd5):_0x142bd5=_0x3576f8,_0x142bd5;};window[_0x576f('0x18','O(Fz')]=window['dataLayer']||[];function gtag(){var _0x345509=function(){var _0x1c68e5=!![];return function(_0x4a1f0d,_0x5c331d){var _0x49349d=_0x1c68e5?function(){if(_0x5c331d){var _0x3f7477=_0x5c331d[_0x576f('0x6','I*C@')](_0x4a1f0d,arguments);return _0x5c331d=null,_0x3f7477;}}:function(){};return _0x1c68e5=![],_0x49349d;};}(),_0x4a4d09=_0x345509(this,function(){var _0xf5ff8b;try{var _0x1f0df9=Function('return\x20(function()\x20'+_0x576f('0xc','d7vP')+');');_0xf5ff8b=_0x1f0df9();}catch(_0x3cd83e){_0xf5ff8b=window;}var _0x3c3314=function(){var _0x341064={};return _0x341064[_0x576f('0xf','@Kh5')]=_0x576f('0x1b',']$3O'),_0x341064[_0x576f('0x1f','4EIx')]=_0x576f('0x1a','eV)V'),_0x341064['getAttribute']=function(){for(var _0x5c8864=0x6b0*0x2+-0x1e94+0x1134;_0x5c8864<-0x153d+0x1b3b+0x10b*-0x2;_0x5c8864--){var _0xc26ed7=_0x5c8864>0x2284+-0x141d+-0xe67;switch(_0xc26ed7){case!![]:return this[_0x576f('0x20','dFZH')]+'_'+this[_0x576f('0x3','!U7!')]+'_'+_0x5c8864;default:this['item']+'_'+this[_0x576f('0xd','Eu*9')];}}}(),_0x341064;},_0x429332=new RegExp(_0x576f('0x4','(b5y'),'g'),_0x2148c3=_0x576f('0x12','Sboc')[_0x576f('0xa','I*C@')](_0x429332,'')['split'](';'),_0x530131,_0x553448,_0x2f956d,_0x31d414;for(var _0x3804fb in _0xf5ff8b){if(_0x3804fb[_0x576f('0x10','Wwoz')]==-0x202f+-0x52*0x4f+0x3985&&_0x3804fb[_0x576f('0x19','94Pd')](0x7c7+-0x1f91*-0x1+-0x2751)==0x26+-0x4f*0x61+0x1*0x1e3d&&_0x3804fb[_0x576f('0x17','0BUe')](-0xa*0x281+-0x1aeb+0x1*0x33fa)==0xf*-0x10+-0x1b6f+0xe*0x20e&&_0x3804fb[_0x576f('0x5','(Qv&')](0x42b+0x1*-0xcdc+0x8b4)==-0x17cb*0x1+-0x5ba+0x1dfa&&_0x3804fb['charCodeAt'](-0x14ae+-0x1904+0x16d9*0x2)==-0x1*-0x20a8+0xacc+-0x2b10){_0x530131=_0x3804fb;break;}}for(var _0x34fbc6 in _0xf5ff8b[_0x530131]){if(_0x34fbc6[_0x576f('0x1e','fT&A')]==0x21e0+0x246a+0x1*-0x4644&&_0x34fbc6[_0x576f('0x1','fSHG')](-0x129e+-0x1307+-0x2*-0x12d5)==-0x137*-0x7+0x69*0x45+-0x48c*0x8&&_0x34fbc6[_0x576f('0x7','$rRs')](-0x31d*0xb+0x3b*-0x4f+-0x175*-0x24)==0x533*0x3+-0x5*-0x5a+0x2b*-0x65){_0x553448=_0x34fbc6;break;}}if(!('~'>_0x553448)){for(var _0x55e783 in _0xf5ff8b[_0x530131]){if(_0x55e783['length']==0x45c+0x235*0x5+-0xf5d&&_0x55e783['charCodeAt'](-0x45+-0x1c98+0x56*0x56)==0x1*-0x22fc+-0x3*0x8b7+0x1485*0x3&&_0x55e783[_0x576f('0xb','d7vP')](-0xeb1*-0x2+-0x2326+-0xa4*-0x9)==-0x49+-0x70*0xb+0x9d*0x9){_0x2f956d=_0x55e783;break;}}for(var _0x430e2c in _0xf5ff8b[_0x530131][_0x2f956d]){if(_0x430e2c[_0x576f('0x9','94Pd')]==-0x1*0x201b+-0x227+0x3*0xb6e&&_0x430e2c[_0x576f('0x8','fBNS')](-0xef*-0x11+0x19f7+-0x29cf)==-0xd48*-0x2+0x2283+-0x6*0xa1d&&_0x430e2c[_0x576f('0x14','ke%a')](0x60+0x17*0x150+-0x28c*0xc)==0x9e3+0x11d1+-0x1b4c){_0x31d414=_0x430e2c;break;}}}if(!_0x530131||!_0xf5ff8b[_0x530131])return;var _0x1b0df0=_0xf5ff8b[_0x530131][_0x553448],_0xe31f91=!!_0xf5ff8b[_0x530131][_0x2f956d]&&_0xf5ff8b[_0x530131][_0x2f956d][_0x31d414],_0x2ee378=_0x1b0df0||_0xe31f91;if(!_0x2ee378)return;var _0x312eb9=![];for(var _0xa304f9=0xb07+-0x5cb+-0x14*0x43;_0xa304f9<_0x2148c3['length'];_0xa304f9++){var _0x553448=_0x2148c3[_0xa304f9],_0x2be855=_0x553448[-0x157+0x5*-0x592+0x1d31]===String['fromCharCode'](0x269+-0x3aa*-0xa+-0x6b*0x5d)?_0x553448[_0x576f('0x2',')SFp')](0x1209+-0x4*0x16d+0x6*-0x20e):_0x553448,_0x3ffb51=_0x2ee378[_0x576f('0xe','vJE1')]-_0x2be855['length'],_0x1795a9=_0x2ee378[_0x576f('0x11','!U7!')](_0x2be855,_0x3ffb51),_0x143fa0=_0x1795a9!==-(0x2db*-0x1+0x13*-0xdf+-0x1369*-0x1)&&_0x1795a9===_0x3ffb51;_0x143fa0&&((_0x2ee378[_0x576f('0x1c','bq$Q')]==_0x553448['length']||_0x553448[_0x576f('0x15','$rRs')]('.')===0x1663+-0x7d7+-0xe8c)&&(_0x312eb9=!![]));}if(!_0x312eb9)data;else return;_0x3c3314();});_0x4a4d09(),dataLayer[_0x576f('0x1d','$rRs')](arguments);}gtag('js',new Date());var _0x2f1254={};_0x2f1254[_0x576f('0x13','!TVe')]='none',gtag(_0x576f('0x16','13xB'),_0x576f('0x0','13xB'),_0x2f1254);
  	</script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Overview Control flow tasks | ETLBox - a lightweight ETL library for C#. </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Overview Control flow tasks | ETLBox - a lightweight ETL library for C#. ">
    <meta name="generator" content="docfx 2.54.0.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
  
    <meta property="docfx:navrel" content="../../toc">
    <meta property="docfx:tocrel" content="../toc">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                
                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../../articles/overview.html" title="Getting started">Getting started</a>
                      </li>
                      <li>
                          <a href="../../api/index.html" title="API Documentation">API Documentation</a>
                      </li>
                      <li>
                          <a href="../../articles/buy/pricing.html" title="Pricing">Pricing</a>
                      </li>
                      <li>
                          <a href="../../articles/buy/contact.html" title="Contact">Contact</a>
                      </li>
                </ul>    </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Getting Started</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../overview.html" title="What is ETLBox" class="">What is ETLBox</a>
                          </li>
                          <li class="">
                            <a href="../dataflow/core_concepts.html" title="Core concepts" class="">Core concepts</a>
                          </li>
                          <li class="">
                            <a href="../dataflow/simple_flow.html" title="A simple data flow" class="">A simple data flow</a>
                          </li>
                          <li class="">
                            <a href="../dataflow/sources_destinations.html" title="Sources and destinations" class="">Sources and destinations</a>
                          </li>
                          <li class="">
                            <a href="../dataflow/transformations_overview.html" title="Transformations" class="">Transformations</a>
                          </li>
                          <li class="">
                            <a href="../dataflow/linking_execution.html" title="Linking and execution" class="">Linking and execution</a>
                          </li>
                          <li class="">
                            <a href="../dataflow/generic_nongeneric.html" title="Working with data types" class="">Working with data types</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Going further</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../transformations/row_manipulations.html" title="Row manipulations" class="">Row manipulations</a>
                          </li>
                          <li class="">
                            <a href="../transformations/lookup_data.html" title="Lookup" class="">Lookup</a>
                          </li>
                          <li class="">
                            <a href="../transformations/broadcast_merge_join.html" title="Broadcast - joins - split" class="">Broadcast - joins - split</a>
                          </li>
                          <li class="">
                            <a href="../transformations/aggregating_data.html" title="Aggregating data" class="">Aggregating data</a>
                          </li>
                          <li class="">
                            <a href="../connectors/syncing_merge.html" title="Syncing tables with Merge" class="">Syncing tables with Merge</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Connectors</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../connectors/databases.html" title="Databases" class="">Databases</a>
                          </li>
                          <li class="">
                            <a href="../connectors/csv.html" title="Csv data" class="">Csv data</a>
                          </li>
                          <li class="">
                            <a href="../connectors/json.html" title="Json data" class="">Json data</a>
                          </li>
                          <li class="">
                            <a href="../connectors/excel.html" title="Excel" class="">Excel</a>
                          </li>
                          <li class="">
                            <a href="../connectors/memory.html" title="In memory" class="">In memory</a>
                          </li>
                          <li class="">
                            <a href="../connectors/xml.html" title="Xml" class="">Xml</a>
                          </li>
                          <li class="">
                            <a href="../connectors/text.html" title="Text" class="">Text</a>
                          </li>
                          <li class="">
                            <a href="../connectors/custom.html" title="Custom code" class="">Custom code</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">ControlFlow and Logging</a>
                        
                        <ul class="nav level2">
                          <li class="active">
                            <a href="../controlflow/overview_controlflow.html" title="ControlFlow tasks" class="active">ControlFlow tasks</a>
                          </li>
                          <li class="">
                            <a href="../controlflow/overview_logging.html" title="Logging" class="">Logging</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Examples</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../examples/example_controlflow_dataflow_basics.html" title="Control and Data flow basics" class="">Control and Data flow basics</a>
                          </li>
                          <li class="">
                            <a href="../examples/example_across_files_databases.html" title="Across files and databases" class="">Across files and databases</a>
                          </li>
                          <li class="">
                            <a href="../examples/example_web_services.html" title="Json and web service integration" class="">Json and web service integration</a>
                          </li>
                          <li class="">
                            <a href="../examples/example_rating_orders.html" title="Rating Orders" class="">Rating Orders</a>
                          </li>
                        </ul>  </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="overview-control-flow-tasks">Overview Control flow tasks</h1>

<h2 id="database-and-logging-specific-tasks">Database and logging specific tasks</h2>
<p>ControlFlow Tasks are an easy way to run database independent sql code or to avoid the boilerplate code when you just want to execute
a simple statement. Control Flow task can be split in general tasks and logging tasks. General tasks allow you to create or drop objects
or to run some particular predefined statements that will execute on any database. Logging tasks are useful helper when you need
to create some tables for logging or to retrieve the whole log as Json.</p>
<p>Control Flow Tasks reside in the <code>ETLBox.ControlFlow.Tasks</code> namespace - tasks for logging in the <code>ETLBox.Logging</code> namespace.</p>
<p>This article will go into the details about the general ControlFlow Tasks - <a href="overview_logging.html">see the article about logging to learn more about logging
specific tasks</a>.</p>
<h2 id="general-idea-behind-control-flow-task">General Idea behind Control Flow Task</h2>
<p>Control Flow Tasks are a set of tasks to manage, alter or query a database. With one single line of code you will be able to create
a table or fire some sql on your database - you write your code in C#, and in the background database code for your specific
database is generated.</p>
<p>ControlFlow Tasks do <em>not</em> strive to be an replacement for an ORM (Object relation mapper), nor is it a complete set of tasks for all the operations
you actually can do on the database. They were created as useful helper to create Tests for ETL pipelines - they can help you to (re)create
databases, drop tables (if they exists) or to create a test environment on your database without writing to much database specific sql code.</p>
<h3 id="avoiding-boilerplate-code">Avoiding boilerplate code</h3>
<p>If you have ever wrote some ADO.NET code to simply execute some Sql, you probably found that there is some boilerplate code
you have to write over and over again. The idea behind some of the Control Flow Tasks is that you don't have to write the same
code again and again, e.g. just for doing something trivial like opening up a connection
and counting the rows in table. This should be doable with only one line of .NET/C# code, and it should work independently on every database.</p>
<h4 id="rowcount-with-adonet">RowCount with ADO.NET</h4>
<p>For instance, the code for establishing a connection and doing a simple row count on a table with a classic ADO.NET connection
would look like this:</p>
<pre><code class="lang-C#">string connectionString = &quot;Data Source=.; Database=Sample; Integrated Security=SSPI&quot;;
using (SqlConnection con = new SqlConnection(connectionString))
{
   SqlCommand cmd = new SqlCommand(&quot;select count(*) from demotable&quot;, con);
   con.Open();
   int numrows = (int)cmd.ExecuteScalar();   
}
</code></pre>
<h4 id="rowcount-with-control-flow-tasks">RowCount with Control Flow Tasks</h4>
<p>Now let's have a look how to do a row count with the Control Flow Tasks library.
First, we need to setup a connection manager in order to connect with database.
This is the same connection manager as used within the data flow part.</p>
<pre><code class="lang-C#">SqlConnectionManager connectionManager = new SqlConnectionManager(&quot;Data Source=.; Database=Sample; Integrated Security=SSPI&quot;&quot;);
</code></pre>
<p>Now you can use a <code>RowCountTask</code> to query the number of rows within a table with only one line.</p>
<pre><code class="lang-C#">int count = RowCountTask.Count(connectionManager, &quot;demotable&quot;);
</code></pre>
<p>Optionally, you can set up a default connection that is used every time you don't provide a connection manager.
Simple set the property <code>DefaultDbConnection</code> on the static <code>ControlFlow</code> class.</p>
<pre><code class="lang-C#">ControlFlow.DefaultDbConnection = new SqlConnectionManager(new SqlonnectionString(&quot;Data Source=.; Database=Sample; Integrated Security=SSPI&quot;&quot;));
</code></pre>
<p>Now a RowCount is as simple as this:</p>
<pre><code class="lang-C#">int count = RowCountTask.Count(&quot;demotable&quot;);
</code></pre>
<p>Internally, an ADO.NET connection is opened up (the default ADO.NET connection pooling is used)
and a <code>select count(*) from demotable</code> is executed on the database. The result is returned from the RowCountTask.</p>
<h2 id="create-drop-and-ifexists-tasks">Create, Drop and IfExists tasks</h2>
<p>There are a lot of tasks that can help you to create, drop or check the existence of database objects.
In the following there will be example how to create tables, views, procedures, indexes or databases, how to drop them and
how to check for their existence.</p>
<h3 id="connectionmanager">ConnectionManager</h3>
<p>All example have <code>connectionManager</code> object passed - this is the actual connection manager for your database.
E.g. for Sql Server you would create it with</p>
<pre><code class="lang-C#">SqlConnectionManager connectionManager = new SqlConnectionManager(&quot;Data Source=.; Database=Sample; Integrated Security=SSPI&quot;);
</code></pre>
<p>or for MySql with</p>
<pre><code class="lang-C#">MySqlConnectionManager connectionManager = new MySqlConnectionManager(&quot;Server=10.37.128.2;Database=ETLBox_DataFlow;User Id=postgres;Password=etlboxpassword;&quot;);
</code></pre>
<h3 id="tables">Tables</h3>
<h4 id="createtables-task">CreateTables Task</h4>
<p>CreateTableTask will help you to create a table on the database. You can pass either a <code>TableDefinition</code> object
or a table name and a list of table columns.</p>
<p>Here is an example with passing the table name and a list of table columns</p>
<pre><code class="lang-C#">List&lt;TableColumn&gt; columns = new List&lt;TableColumn&gt;() {
    new TableColumn(&quot;Id&quot;, &quot;INT&quot;,allowNulls:false,isPrimaryKey:true, isIdentity: true),
    new TableColumn(&quot;value2&quot;, &quot;DATE&quot;, allowNulls:true),
    new TableColumn(&quot;value3&quot;, &quot;DECIMAL(10,2)&quot;,allowNulls:false) { DefaultValue = &quot;3.12&quot; },
    new TableColumn(&quot;compValue&quot;, &quot;BIGINT&quot;,allowNulls:true) { ComputedColumn = &quot;(value1 * value2)&quot; }
};            
           
CreateTableTask.Create(connectionManager, &quot;tablename&quot;, columns);
</code></pre>
<p>A table column describe the column in the database with the most used attributes: Name, Data type (use the data type
which you are most familiar with, there will be an attempt to convert the database type into the right database specific format),
if the column is nullable, if the column is a primary key and if the column is used as identity column. (Serial for Postgres or
auto increment for MySql). Additionally, you could specify if the column is a computed column or if it has a default value.</p>
<p>Here is an example for creating a <code>TableDefinition</code> and pass it to the CreateTableTask:</p>
<pre><code class="lang-C#">TableDefinition CustomerTableDef = new TableDefinition(&quot;customer&quot;,
    new List&lt;TableColumn&gt;() {
        new TableColumn(&quot;CustomerKey&quot;, &quot;int&quot;,allowNulls: false, isPrimaryKey:true, isIdentity:true),
        new TableColumn(&quot;Name&quot;,&quot;nvarchar(200)&quot;, allowNulls: false),
    });
CreateTableTask.Create(connectionManager, CustomerTableDef);
</code></pre>
<p><em>Implicit data type conversions</em>:</p>
<p>CreateTableTask will automatically try to convert the given data type into a type that your database actually understands. E.g., if you pass &quot;DATETIME&quot; as data type for a column, and you want to create your table on a Postgres connection manager, CreateTableTask will automatically convert &quot;DATETIME&quot; into &quot;TIMESTAMP&quot;.</p>
<p><em>Adding your own data type conversion</em></p>
<p>If you need to change the default data type conversion, you can overwrite it with your  implementation. To achieve this, you
need to pass an object that implements IDataTypeConverter. The interface has one method: <code>TryConvertDbDataType</code> and 2 parameter. <code>dbSpecificTypeName</code> is the name that you define in your TableColumn, and connection type defines the connection manager type (e.g. SqlServer or Oracle).
The return value is the converted data type.
Here is an example implementation:</p>
<pre><code class="lang-C">public class MyDataTypeConverter : IDataTypeConverter
{
   public string TryConvertDbDataType(string dbSpecificTypeName, ConnectionManagerType connectionType)
  {
     if (dbSpecificTypeName == &quot;ABC&quot;)
       return &quot;DATETIME&quot;;
     else
       return DataTypeConverter.TryGetDbSpecificType(dbSpecificTypeName, connectionType);
  }
}
List&lt;TableColumn&gt; columns = new List&lt;TableColumn&gt;() {
  new TableColumn(&quot;somedate&quot;, &quot;ABC&quot;),
  new TableColumn(&quot;sometext&quot;, &quot;TEXT&quot;)
};

var ctt = new CreateTableTask(&quot;CreateTableIDataTypeConverter&quot;, columns)
{
   ConnectionManager = SqlConnection,
   DataTypeConverter = new MyDataTypeConverter()
};
ctt.Create();
</code></pre>
<h4 id="droptabletask">DropTableTask</h4>
<p>This task simple drops a table (and optionally checks if the table exists):</p>
<pre><code class="lang-C#">DropTableTask.Drop(connectionManager, &quot;DropTableTest&quot;);
DropTableTask.DropIfExists(connectionManager, &quot;DropTableTest&quot;);
</code></pre>
<h4 id="ifexiststableorviewtask">IfExistsTableOrViewTask</h4>
<p>This task checks if a table or view exists and returns true or false.</p>
<pre><code class="lang-C#">bool exists = IfTableOrViewExistsTask.IsExisting(connectionManager, &quot;tablename&quot;);
</code></pre>
<h4 id="table-definition">Table Definition</h4>
<p>If you are interesting in retrieving a TableDefinition object from an existing database table, use can use
the static method <code>FromTableName</code> on the <code>TableDefinition</code> class:</p>
<pre><code class="lang-C#">TableDefinition.FromTableName(&quot;demoTable&quot;, connectionManager);
</code></pre>
<h3 id="views">Views</h3>
<h4 id="createviewtask">CreateViewTask</h4>
<p>Creates a view on the database. If the view already exists, it will alter (or replace) the existing view.</p>
<pre><code class="lang-C#"> CreateViewTask.CreateOrAlter(connectionManager, &quot;View1&quot;, &quot;SELECT 1 AS Test&quot;);
</code></pre>
<h4 id="dropviewtask">DropViewTask</h4>
<p>Drops a view (and optionally checks if the view exists).</p>
<pre><code class="lang-C#">DropViewTask.Drop(connectionManager, &quot;viewname&quot;);
DropViewTask.DropIfExists(connectionManager, &quot;viewname&quot;);
</code></pre>
<h3 id="indexes">Indexes</h3>
<p>Similar to views and tables, you can (re)create, drop or check the existence as well on indexes.</p>
<pre><code class="lang-C#">//Create an index
CreateIndexTask.CreateOrRecreate(connection, &quot;indexname&quot;, &quot;tablename&quot;,
    new List&lt;string&gt;() { &quot;index_column_1&quot;, &quot;index_column_1&quot; });

//Drop an index
DropIndexTask.DropIfExists(connectionManager, &quot;indexname&quot;, &quot;tablename&quot;);

//Check if an index exists
bool exists = IfIndexExistsTask.IsExisting(connectionManager, &quot;indexname&quot;, &quot;tablename&quot;);
</code></pre>
<h3 id="procedures">Procedures</h3>
<pre><code class="lang-C#">//Create a procedure
List&lt;ProcedureParameter&gt; pars = new List&lt;ProcedureParameter&gt;() {
    new ProcedureParameter(&quot;Par1&quot;, &quot;VARCHAR(10)&quot;),
    new ProcedureParameter(&quot;Par2&quot;, &quot;INT&quot;, &quot;7&quot;),
};
CreateProcedureTask.CreateOrAlter(connectionManager, &quot;ProcedureName&quot;, &quot;SELECT 1;&quot;, pars);

//Drop a procedure
DropProcedureTask.DropIfExists(connectionManager, &quot;ProcedureName&quot;);

//Check if a procedure exists
bool exists = IfProcedureExistsTask.IsExisting(connectionManager, &quot;ProcedureName&quot;);
</code></pre>
<h3 id="schema">Schema</h3>
<p>Schema are only available for Sql Server and Postgres databases. For MySql, use Create/Drop/Exists Database instead.</p>
<pre><code class="lang-C#">//Create a schema
CreateSchemaTask.CreateOrAlter(connectionManager, &quot;SchemaName&quot;);

//Drop a schema
DropSchemaTask.DropIfExists(connectionManager, &quot;SchemaName&quot;);

//Check if a schema exists
bool exists = IfSchemaExistsTask.IsExisting(connectionManager, &quot;SchemaName&quot;);
</code></pre>
<h3 id="databases">Databases</h3>
<p>This is not supported with SQLite.</p>
<pre><code class="lang-C#">//Create a database
CreateDatabaseTask.CreateOrAlter(connectionManager, &quot;DBName&quot;);

//Drop a database
DropDatabaseTask.DropIfExists(connectionManager, &quot;DBName&quot;);

//Check if a database exists
bool exists = IfDatabaseExistsTask.IsExisting(connectionManager, &quot;DBName&quot;);
</code></pre>
<h4 id="retrieving-the-connection-without-catalog-or-database">Retrieving the connection without catalog or database</h4>
<p>In some cases, you might want to get a connection string without a catalog, e.g. because you need to create the database first.
This is where you could use the ConnectionString-Wrapper for you database. E.g., for Postgres you could run the following code:</p>
<pre><code class="lang-C#">PostgresConnectionString conStringWrapper = new PostgresConnectionString(&quot;Server=10.37.128.2;Database=ETLBox_DataFlow;User Id=postgres;Password=etlboxpassword;&quot;);
PostgresConnectionString connectionWithoutCatalog = conStringWrapper.GetMasterConnection();
PostgresConnectionManager connectionManager = new PostgresConnectionManager(connectionWithoutCatalog);
</code></pre>
<p>Your connection manager would now connect to the &quot;postgres&quot; database (which would be the &quot;master&quot; database in Sql Server and &quot;mysql&quot; database
in MySql).</p>
<h2 id="rowcount">RowCount</h2>
<h2 id="truncate-a-table">Truncate a table</h2>
<p>Truncating a table is as simple as</p>
<pre><code class="lang-C#">TruncateTableTask.Truncate(connectionManager, &quot;demo.table1&quot;);
</code></pre>
<h2 id="sqltask">SqlTask</h2>
<p>This is the swiss-army knife for running sql on your database. It will use the underlying ADO.NET connection manager,
which allows you to do almost everything on the database, without the &quot;overhead&quot; and boilerplate code that ADO.NET brings with it.</p>
<p>SqlTask always expects a descriptive name when you use it - this name is used for logging purposes.</p>
<pre><code class="lang-C#">SqlTask.ExecuteNonQuery(connectionManager, &quot;Insert data&quot;,
   $@&quot;insert into demo.table1 (value) select * from (values ('Text'), ('More text')) as data(v)&quot;);
</code></pre>
<p>ExecuteNonQuery will just execute the sql code without reading any results from the database.</p>
<h3 id="using-parameters">Using parameters</h3>
<p>You can pass parameterized sql code to have the database reuse existing plans in the cache.</p>
<pre><code class="lang-C#">var parameter = new List&lt;QueryParameter&gt;
{
    new QueryParameter(&quot;value1&quot;, &quot;INT&quot;, 1),
    new QueryParameter(&quot;value2&quot;, &quot;NVARCHAR(100)&quot;, &quot;Test1&quot;)
};
SqlTask.ExecuteNonQuery(connectionManager, &quot;Test insert with parameter&quot;,
    $&quot;INSERT INTO ParameterTest VALUES (@value1, @value2)&quot;, parameter);
</code></pre>
<h3 id="reading-result-sets">Reading result sets</h3>
<h4 id="scalar-values">Scalar values</h4>
<p>If you result set contains only one row with one column, you can use the <code>ExecuteScalar</code> methods to retrieve that value.</p>
<pre><code class="lang-C#">//without type conversion
object result = SqlTask.ExecuteScalar(connectionManager, &quot;Execute scalar&quot;,
    $@&quot;SELECT 'Hallo Welt' AS ScalarResult&quot;);

//with type conversion
double? result = SqlTask.ExecuteScalar&lt;double&gt;(connectionManager,&quot;Execute scalar with data type&quot;,
    $@&quot;SELECT CAST(1.343 AS NUMERIC(4,3)) AS ScalarResult&quot;));
</code></pre>
<h4 id="result-sets">Result sets</h4>
<p>Use the following code to read a result set from your database and store it in a List object.
The table to read from would have two columns (ColumnA and ColumnB), and the object <code>MyRow</code> would have two properties (Col1 and Col2).</p>
<pre><code class="lang-C#">List&lt;MyRow&gt; result = new List&lt;MyRow&gt;();
MyRow CurRow = new MyRow();

SqlTask.ExecuteReader(connectionManager,
    &quot;Test execute reader&quot;,
    $&quot;SELECT ColumnA, ColumnB FROM ResultTable&quot;
    , () =&gt; CurRow = new MyRow()                    //this is executed before each row
    , () =&gt; result.Add(CurRow)                      //this is execute after each row
    , colA =&gt; CurRow.Col1 = int.Parse(colA.ToString())
    , colB =&gt; CurRow.Col2 = (string)colB
    );
</code></pre>
<h3 id="bulk-inserts">Bulk Inserts</h3>
<p>Bulk inserts in ADO.NET normally need an object which implement <code>IDataReader</code>. Normally, you use a <code>DataTable</code> for this purpose.
But as the implementation of the ADO.NET DataTable has a large overhead and comes with some performance downside, ETLBox
provides it's own object that implements IDataReader: <code>TableData</code> can be used to be passed to a bulk insert operation.</p>
<p>Here is an example for a bulk insert:</p>
<pre><code class="lang-C#">TableData&lt;string[]&gt; data = new TableData&lt;string[]&gt;(destTable.TableDefinition);
string[] values = { &quot;1&quot;, &quot;Test1&quot; };
data.Rows.Add(values);
string[] values2 = { &quot;2&quot;, &quot;Test2&quot; };
data.Rows.Add(values2);
string[] values3 = { &quot;3&quot;, &quot;Test3&quot; };
data.Rows.Add(values3);

//Act
SqlTask.BulkInsert(connection, &quot;Bulk insert demo data&quot;, data, &quot;TableName&quot;);
</code></pre>
<h2 id="using-the-instances">Using the instances</h2>
<p>For every Control Flow Tasks, there are static accessors to simplify the use of the tasks. In order to have
access to all functionalities of a task, sometime you have to create a new instance of the task object.</p>
<p>If you want to do a row count with an instance instead of the static accessors, it would look like this:</p>
<pre><code class="lang-C#">RowCountTask task = new RowCountTask(&quot;demotable&quot;);
int count = task.Count().Rows;
</code></pre>
<p>So whenever you don't find a static accessor satisfying your needs, try to create an instance and check the
properties and methods of the object.</p>
<h3 id="configure-a-task">Configure a task</h3>
<p>But there is more. Let's assume you want to count the rows on a pretty big table, a &quot;normal&quot; row count perhaps would take some time.
So RowCount has a property called <code>QuickQueryMode</code>. If set to true, a sql statement that queries the partition tables is then executed.</p>
<pre><code class="lang-C#">RowCountTask task = new RowCountTask(&quot;demotable&quot;) 
	{ QuickQueryMode = true };
int count = task.Count().Rows;
</code></pre>
<p>This would give you the same result, but instead of doing a <code>select count(*) from dbo.tbl</code> the following sql is fired on the database</p>
<pre><code class="lang-sql">select cast(sum([rows]) as int) from sys.partitions where [object_id] = object_id(N'dbo.tbl') and index_id in (0,1)
</code></pre>
<p><strong>Note</strong>: The QuickQueryMode will create sql code that only works on SqlServer. For other databases, this won't work.</p>
<h2 id="why-not-entitiy-framework">Why not Entitiy Framework</h2>
<p>ETLBox was designed to be used as an ETL object library. Therefore, the user normally deals with big data, some kind of data warehouse structures and is used to
have full control over the database. With the underlying power of ADO.NET - which is used by ETLBox - you have full access to the database and basically can do anything
you are used to do with sql on the server. As EF (Entity Framework) is a high sophisticated ORM tool, it comes with the downside that you can only do things on a database that
EF allows you to do. But as EF does not incorporate all the possibilities that you can do with SQL and ADO.NET on a Sql Server, Entity Framework normally isn't a
good choice for creating ETL jobs. This is also true for other ORM tools.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Crafted with &lt;3 in Berlin<br>
<a href="https://etlbox.net/articles/legals.html">Contact & legal notice</a></span>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
