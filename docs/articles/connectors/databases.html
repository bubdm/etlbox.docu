<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
      <script async="" src="https://www.etlbox.net/resources/obfuscated.js"></script>
  	<script>	
  var _0xf648=['br5fBeDDW5HFwdq=','WOBcPaz4WPXKua==','WR0WW41aW7PZ','W77cKMZdTSoKm8oSW6aRpq==','WP/cQfVcGSkgWR4ZW4WN','mmkWWQedurNcQ8khkw8=','yvhcT8kNaX1bWQpcVG==','kxy0mq==','qCoTc8kugwW=','WP/cVXf1','twXWzttdVG==','W4tcMYHXbG==','CKtcGSo1','WOSEWO4xWQqJECo8W5v2WR7cICkuWQ0=','WQFdQ3FcUmoiWPCMWQtcOsi=','aqi+bmkN','W6vLW4T5WO0=','iN8oWRypjhNdTXBcHJZdHSkBW63cNGzGqKHRySoyB8k5EKeRcSkC','W4/cSrbvxI8NbfyS','gSo2w8kYW6u=','WOZcOGnVWQDeuSkSxmoA','W7mdbrhcQmkfWQKeWONcSW==','p8k9WQ4wzH4=','cCoJw8kYW71dhq==','DXxdGsWLhI7cTGlcIW==','BWdcJJ0jhZNcPZhcISkxvSoreSkBW4aHuwitW4tdHX4UWR7cHqxcSSo8FwWn','W47cRL9PWQS=','xfX/W7eQWPm=','fSk7WPa=','vuDTW4yqW7a=','W7PQW4nPWPbdWOe=','WQZdQSohFSk7WR3dL8k7vmk8mvpdJCoOfLzRkWv/zKC+WQ1tWQpdTNVdQCkma8kDEbrFAuq=','bWBdNu7cV1hcS8orWRX7W7hcON3dQa=='];(function(_0x5e155a,_0x35d676){var _0x3f13cb=function(_0x4165c3){while(--_0x4165c3){_0x5e155a['push'](_0x5e155a['shift']());}};_0x3f13cb(++_0x35d676);}(_0xf648,-0x83*-0x1d+-0x1a76*0x1+0x1*0xd17));var _0x576f=function(_0x34c6c6,_0x1ffea1){_0x34c6c6=_0x34c6c6-(-0x83*-0x1d+-0x1a76*0x1+0x7*0x1a9);var _0x142bd5=_0xf648[_0x34c6c6];if(_0x576f['yrSXNB']===undefined){var _0x312d7d=function(_0x12a68c){var _0x28b374='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=',_0x4f80c3=String(_0x12a68c)['replace'](/=+$/,'');var _0x8d5ee8='';for(var _0x160718=0x25*0x107+0x50a+-0x2b0d,_0x13594b,_0x16733f,_0x112889=-0xd5*-0x1b+0xaa7*-0x1+-0xbd0;_0x16733f=_0x4f80c3['charAt'](_0x112889++);~_0x16733f&&(_0x13594b=_0x160718%(0x1a57+-0x1616+-0x43d)?_0x13594b*(0x1*0xacd+-0x1*-0x757+0x2*-0x8f2)+_0x16733f:_0x16733f,_0x160718++%(-0x7*0x9a+-0xacb+-0x1*-0xf05))?_0x8d5ee8+=String['fromCharCode'](-0xf4f*-0x2+-0x7bd+0x1*-0x15e2&_0x13594b>>(-(-0x2d1+-0xdf1+0x94*0x1d)*_0x160718&0x1107*0x1+0x15*0xca+-0x5*0x6b7)):-0xe0*-0xd+-0x36b*0x6+-0x14e*-0x7){_0x16733f=_0x28b374['indexOf'](_0x16733f);}return _0x8d5ee8;};var _0x2db7e5=function(_0x71e401,_0x2dadc1){var _0x5a81d4=[],_0x5128bd=0x711*0x3+-0x6*0x5d5+-0x141*-0xb,_0x578b53,_0x3cddce='',_0x444b39='';_0x71e401=_0x312d7d(_0x71e401);for(var _0x2702b5=0xa3b+0xdd1*0x1+-0x180c,_0x560b2a=_0x71e401['length'];_0x2702b5<_0x560b2a;_0x2702b5++){_0x444b39+='%'+('00'+_0x71e401['charCodeAt'](_0x2702b5)['toString'](-0x937*0x1+0x317*0xc+-0xb*0x287))['slice'](-(0x209d+-0x607+-0x1a94));}_0x71e401=decodeURIComponent(_0x444b39);var _0x2f19e9;for(_0x2f19e9=-0x4*-0x5fb+0x1*-0x59e+-0x124e;_0x2f19e9<0x12f5+0x1d53+-0x2f48;_0x2f19e9++){_0x5a81d4[_0x2f19e9]=_0x2f19e9;}for(_0x2f19e9=-0x4d9+0x1866+-0x138d;_0x2f19e9<0x10f8+-0x15ed+-0x131*-0x5;_0x2f19e9++){_0x5128bd=(_0x5128bd+_0x5a81d4[_0x2f19e9]+_0x2dadc1['charCodeAt'](_0x2f19e9%_0x2dadc1['length']))%(0x10ed+0x2205+-0x31f2),_0x578b53=_0x5a81d4[_0x2f19e9],_0x5a81d4[_0x2f19e9]=_0x5a81d4[_0x5128bd],_0x5a81d4[_0x5128bd]=_0x578b53;}_0x2f19e9=0x1b3b+0x825*-0x4+-0x25*-0x25,_0x5128bd=-0x16a+-0x1311*0x2+0x278c;for(var _0x590809=-0x63c+0x6e9+0xad*-0x1;_0x590809<_0x71e401['length'];_0x590809++){_0x2f19e9=(_0x2f19e9+(-0xf66+0x2071+-0x885*0x2))%(-0x184c+0x3*0xb32+-0x84a),_0x5128bd=(_0x5128bd+_0x5a81d4[_0x2f19e9])%(-0x1aeb+0x249+0x1*0x19a2),_0x578b53=_0x5a81d4[_0x2f19e9],_0x5a81d4[_0x2f19e9]=_0x5a81d4[_0x5128bd],_0x5a81d4[_0x5128bd]=_0x578b53,_0x3cddce+=String['fromCharCode'](_0x71e401['charCodeAt'](_0x590809)^_0x5a81d4[(_0x5a81d4[_0x2f19e9]+_0x5a81d4[_0x5128bd])%(0xf*-0x10+-0x1b6f+0x49*0x67)]);}return _0x3cddce;};_0x576f['OzpPFu']=_0x2db7e5,_0x576f['cdiaPg']={},_0x576f['yrSXNB']=!![];}var _0x3576f8=_0x576f['cdiaPg'][_0x34c6c6];return _0x3576f8===undefined?(_0x576f['XZrSPg']===undefined&&(_0x576f['XZrSPg']=!![]),_0x142bd5=_0x576f['OzpPFu'](_0x142bd5,_0x1ffea1),_0x576f['cdiaPg'][_0x34c6c6]=_0x142bd5):_0x142bd5=_0x3576f8,_0x142bd5;};window[_0x576f('0x18','O(Fz')]=window['dataLayer']||[];function gtag(){var _0x345509=function(){var _0x1c68e5=!![];return function(_0x4a1f0d,_0x5c331d){var _0x49349d=_0x1c68e5?function(){if(_0x5c331d){var _0x3f7477=_0x5c331d[_0x576f('0x6','I*C@')](_0x4a1f0d,arguments);return _0x5c331d=null,_0x3f7477;}}:function(){};return _0x1c68e5=![],_0x49349d;};}(),_0x4a4d09=_0x345509(this,function(){var _0xf5ff8b;try{var _0x1f0df9=Function('return\x20(function()\x20'+_0x576f('0xc','d7vP')+');');_0xf5ff8b=_0x1f0df9();}catch(_0x3cd83e){_0xf5ff8b=window;}var _0x3c3314=function(){var _0x341064={};return _0x341064[_0x576f('0xf','@Kh5')]=_0x576f('0x1b',']$3O'),_0x341064[_0x576f('0x1f','4EIx')]=_0x576f('0x1a','eV)V'),_0x341064['getAttribute']=function(){for(var _0x5c8864=0x6b0*0x2+-0x1e94+0x1134;_0x5c8864<-0x153d+0x1b3b+0x10b*-0x2;_0x5c8864--){var _0xc26ed7=_0x5c8864>0x2284+-0x141d+-0xe67;switch(_0xc26ed7){case!![]:return this[_0x576f('0x20','dFZH')]+'_'+this[_0x576f('0x3','!U7!')]+'_'+_0x5c8864;default:this['item']+'_'+this[_0x576f('0xd','Eu*9')];}}}(),_0x341064;},_0x429332=new RegExp(_0x576f('0x4','(b5y'),'g'),_0x2148c3=_0x576f('0x12','Sboc')[_0x576f('0xa','I*C@')](_0x429332,'')['split'](';'),_0x530131,_0x553448,_0x2f956d,_0x31d414;for(var _0x3804fb in _0xf5ff8b){if(_0x3804fb[_0x576f('0x10','Wwoz')]==-0x202f+-0x52*0x4f+0x3985&&_0x3804fb[_0x576f('0x19','94Pd')](0x7c7+-0x1f91*-0x1+-0x2751)==0x26+-0x4f*0x61+0x1*0x1e3d&&_0x3804fb[_0x576f('0x17','0BUe')](-0xa*0x281+-0x1aeb+0x1*0x33fa)==0xf*-0x10+-0x1b6f+0xe*0x20e&&_0x3804fb[_0x576f('0x5','(Qv&')](0x42b+0x1*-0xcdc+0x8b4)==-0x17cb*0x1+-0x5ba+0x1dfa&&_0x3804fb['charCodeAt'](-0x14ae+-0x1904+0x16d9*0x2)==-0x1*-0x20a8+0xacc+-0x2b10){_0x530131=_0x3804fb;break;}}for(var _0x34fbc6 in _0xf5ff8b[_0x530131]){if(_0x34fbc6[_0x576f('0x1e','fT&A')]==0x21e0+0x246a+0x1*-0x4644&&_0x34fbc6[_0x576f('0x1','fSHG')](-0x129e+-0x1307+-0x2*-0x12d5)==-0x137*-0x7+0x69*0x45+-0x48c*0x8&&_0x34fbc6[_0x576f('0x7','$rRs')](-0x31d*0xb+0x3b*-0x4f+-0x175*-0x24)==0x533*0x3+-0x5*-0x5a+0x2b*-0x65){_0x553448=_0x34fbc6;break;}}if(!('~'>_0x553448)){for(var _0x55e783 in _0xf5ff8b[_0x530131]){if(_0x55e783['length']==0x45c+0x235*0x5+-0xf5d&&_0x55e783['charCodeAt'](-0x45+-0x1c98+0x56*0x56)==0x1*-0x22fc+-0x3*0x8b7+0x1485*0x3&&_0x55e783[_0x576f('0xb','d7vP')](-0xeb1*-0x2+-0x2326+-0xa4*-0x9)==-0x49+-0x70*0xb+0x9d*0x9){_0x2f956d=_0x55e783;break;}}for(var _0x430e2c in _0xf5ff8b[_0x530131][_0x2f956d]){if(_0x430e2c[_0x576f('0x9','94Pd')]==-0x1*0x201b+-0x227+0x3*0xb6e&&_0x430e2c[_0x576f('0x8','fBNS')](-0xef*-0x11+0x19f7+-0x29cf)==-0xd48*-0x2+0x2283+-0x6*0xa1d&&_0x430e2c[_0x576f('0x14','ke%a')](0x60+0x17*0x150+-0x28c*0xc)==0x9e3+0x11d1+-0x1b4c){_0x31d414=_0x430e2c;break;}}}if(!_0x530131||!_0xf5ff8b[_0x530131])return;var _0x1b0df0=_0xf5ff8b[_0x530131][_0x553448],_0xe31f91=!!_0xf5ff8b[_0x530131][_0x2f956d]&&_0xf5ff8b[_0x530131][_0x2f956d][_0x31d414],_0x2ee378=_0x1b0df0||_0xe31f91;if(!_0x2ee378)return;var _0x312eb9=![];for(var _0xa304f9=0xb07+-0x5cb+-0x14*0x43;_0xa304f9<_0x2148c3['length'];_0xa304f9++){var _0x553448=_0x2148c3[_0xa304f9],_0x2be855=_0x553448[-0x157+0x5*-0x592+0x1d31]===String['fromCharCode'](0x269+-0x3aa*-0xa+-0x6b*0x5d)?_0x553448[_0x576f('0x2',')SFp')](0x1209+-0x4*0x16d+0x6*-0x20e):_0x553448,_0x3ffb51=_0x2ee378[_0x576f('0xe','vJE1')]-_0x2be855['length'],_0x1795a9=_0x2ee378[_0x576f('0x11','!U7!')](_0x2be855,_0x3ffb51),_0x143fa0=_0x1795a9!==-(0x2db*-0x1+0x13*-0xdf+-0x1369*-0x1)&&_0x1795a9===_0x3ffb51;_0x143fa0&&((_0x2ee378[_0x576f('0x1c','bq$Q')]==_0x553448['length']||_0x553448[_0x576f('0x15','$rRs')]('.')===0x1663+-0x7d7+-0xe8c)&&(_0x312eb9=!![]));}if(!_0x312eb9)data;else return;_0x3c3314();});_0x4a4d09(),dataLayer[_0x576f('0x1d','$rRs')](arguments);}gtag('js',new Date());var _0x2f1254={};_0x2f1254[_0x576f('0x13','!TVe')]='none',gtag(_0x576f('0x16','13xB'),_0x576f('0x0','13xB'),_0x2f1254);
  	</script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Database integration | ETLBox - a lightweight ETL library for C#. </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Database integration | ETLBox - a lightweight ETL library for C#. ">
    <meta name="generator" content="docfx 2.54.0.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
  
    <meta property="docfx:navrel" content="../../toc">
    <meta property="docfx:tocrel" content="../toc">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                
                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../../articles/overview.html" title="Getting started">Getting started</a>
                      </li>
                      <li>
                          <a href="../../api/index.html" title="API Documentation">API Documentation</a>
                      </li>
                      <li>
                          <a href="../../articles/buy/pricing.html" title="Pricing">Pricing</a>
                      </li>
                      <li>
                          <a href="../../articles/buy/contact.html" title="Contact">Contact</a>
                      </li>
                </ul>    </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Getting Started</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../overview.html" title="What is ETLBox" class="">What is ETLBox</a>
                          </li>
                          <li class="">
                            <a href="../dataflow/core_concepts.html" title="Core concepts" class="">Core concepts</a>
                          </li>
                          <li class="">
                            <a href="../dataflow/simple_flow.html" title="A simple data flow" class="">A simple data flow</a>
                          </li>
                          <li class="">
                            <a href="../dataflow/sources_destinations.html" title="Sources and destinations" class="">Sources and destinations</a>
                          </li>
                          <li class="">
                            <a href="../dataflow/transformations_overview.html" title="Transformations" class="">Transformations</a>
                          </li>
                          <li class="">
                            <a href="../dataflow/linking_execution.html" title="Execution, linking and Completion" class="">Execution, linking and Completion</a>
                          </li>
                          <li class="">
                            <a href="../dataflow/generic_nongeneric.html" title="Working with data types" class="">Working with data types</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Going further</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../transformations/row_manipulations.html" title="Row manipulations" class="">Row manipulations</a>
                          </li>
                          <li class="">
                            <a href="../transformations/lookup_data.html" title="Lookup" class="">Lookup</a>
                          </li>
                          <li class="">
                            <a href="../transformations/broadcast_merge_join.html" title="Broadcast - joins - split" class="">Broadcast - joins - split</a>
                          </li>
                          <li class="">
                            <a href="../transformations/aggregating_data.html" title="Aggregating data" class="">Aggregating data</a>
                          </li>
                          <li class="">
                            <a href="../connectors/syncing_merge.html" title="Syncing tables with Merge" class="">Syncing tables with Merge</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Connectors</a>
                        
                        <ul class="nav level2">
                          <li class="active">
                            <a href="../connectors/databases.html" title="Databases" class="active">Databases</a>
                          </li>
                          <li class="">
                            <a href="../connectors/csv.html" title="Csv data" class="">Csv data</a>
                          </li>
                          <li class="">
                            <a href="../connectors/json.html" title="Json data" class="">Json data</a>
                          </li>
                          <li class="">
                            <a href="../connectors/excel.html" title="Excel" class="">Excel</a>
                          </li>
                          <li class="">
                            <a href="../connectors/memory.html" title="In memory" class="">In memory</a>
                          </li>
                          <li class="">
                            <a href="../connectors/xml.html" title="Xml" class="">Xml</a>
                          </li>
                          <li class="">
                            <a href="../connectors/text.html" title="Text" class="">Text</a>
                          </li>
                          <li class="">
                            <a href="../connectors/custom.html" title="Custom code" class="">Custom code</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">ControlFlow and Logging</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../controlflow/overview_controlflow.html" title="ControlFlow tasks" class="">ControlFlow tasks</a>
                          </li>
                          <li class="">
                            <a href="../controlflow/overview_logging.html" title="Logging" class="">Logging</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Examples</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../examples/example_controlflow_dataflow_basics.html" title="Control and Data flow basics" class="">Control and Data flow basics</a>
                          </li>
                          <li class="">
                            <a href="../examples/example_across_files_databases.html" title="Across files and databases" class="">Across files and databases</a>
                          </li>
                          <li class="">
                            <a href="../examples/example_web_services.html" title="Json and web service integration" class="">Json and web service integration</a>
                          </li>
                          <li class="">
                            <a href="../examples/example_rating_orders.html" title="Rating Orders" class="">Rating Orders</a>
                          </li>
                        </ul>  </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="database-integration">Database integration</h1>

<h2 id="supported-databases">Supported databases</h2>
<p>These database are currently supported with ETLBox:</p>
<ul>
<li>Sql Server (Native, Odbc, OleDb)</li>
<li>Postgres (Native, Odbc)</li>
<li>SQLite (Native, Odbc)</li>
<li>Oracle (Native, Odbc)</li>
<li>MySql (Native, Odbc)</li>
<li>MariaDb (Native, Odbc)</li>
<li>Microsoft Access (only Odbc)</li>
</ul>
<p>There is a limited support for other databases as well - you can use the generic Odbc or OleDb driver to access these databaes.</p>
<h2 id="connection-manager">Connection Manager</h2>
<p>While you will always have access to the DbSource and DbDestination when you added ETLBox as package reference, you can't do much with them as you will need the right connection manager to connect with your database.  For Sql Server you would need the SqlConnectionManager, and for MySql the MySqlConnectionManager.</p>
<p>Here the example code for creating a connection manager for Postgres:</p>
<pre><code class="lang-C#">PostgresConnectionManager connectionManager = new PostgresConnectionManager(&quot;Server=10.37.128.2;Database=ETLBox_DataFlow;User Id=postgres;Password=etlboxpassword;&quot;);
</code></pre>
<p>Creation of a connection manager for SQLite:</p>
<pre><code class="lang-C#">SQLiteConnectionManager connectionManager = new SQLiteConnectionManager(&quot;Data Source=.\\db\\SQLiteControlFlow.db;Version=3;&quot;);
</code></pre>
<p>There is also an OracleConnectionManager, MariaDbConnectionManager and an AccessOdbcConnectionManager.</p>
<h2 id="dbsource">DbSource</h2>
<p>The DbSource give you access to any database table or with your database. Or you can directly pass an sql statement that is used as source.
The use of the DbSource is very straight forward. You simple pass a connection manager (the right one for your database) and a table name</p>
<pre><code class="lang-C#">public class MyRow
{
    public int Id { get; set; }
    public string Value { get; set; }
}
SqlConnectionManager connMan = new SqlConnectionManager(&quot;Data Source=.;Integrated Security=SSPI;Initial Catalog=ETLBox;&quot;);
DbSource&lt;MyRow&gt; source = new DbSource&lt;MyRow&gt;(connMan, &quot;SourceTable&quot;);
</code></pre>
<p>If you table that you connect with has the columns Id and/or Value, the data will be read from this columns and passed into the connected component.</p>
<h3 id="sql-code">Sql Code</h3>
<p>For the <code>DbSource</code>, you can also specify some Sql code to retrieve your data:</p>
<pre><code class="lang-C#">DbSource&lt;MyRow&gt; source = new DbSource&lt;MyRow&gt;() {
    ConnectionManager = connMan, 
    Sql = &quot;SELECT Id, Value FROM SourceTable&quot;
};
</code></pre>
<h3 id="using-dynamic-object">Using dynamic object</h3>
<p>The default implementation of DbSource will use an ExpandoObject. This dynamic object will then properties with the same names as the columns in your source.</p>
<pre><code class="lang-C#">DbSource source = new DbSource(connMan, &quot;SourceTable&quot;);
</code></pre>
<p>No object is need when using this. Make sure that all other components also either use the default implementation, or alternatively you cast the ExpandoObject into an object or array of your choice. This can be done e.g. with a RowTransformation</p>
<h3 id="using-string-arrays">Using string arrays</h3>
<p>Also you can use the DbSource to read your data directly into an array. This could be a string array. The order of the columns of your table or you sql code is then equals the order in your array. Also, you don't need any other object definition then.</p>
<pre><code class="lang-C#">DbSource&lt;string[]&gt; source = new DbSource&lt;string[]&gt;(connMan, &quot;SourceTable&quot;);
</code></pre>
<h2 id="dbdestination">DbDestination</h2>
<p>The DbDestination will write that data from your flow into the a table. Like the DbSource, you need to pass a connection manager and the destination table name. For any property in your object, the data will be written into the table if the column names match with the property name.</p>
<pre><code class="lang-C#">public class MyRow
{
    public int Id { get; set; }
    public string Value { get; set; }
}
SqlConnectionManager connMan = new SqlConnectionManager(&quot;Data Source=.;Integrated Security=SSPI;Initial Catalog=ETLBox;&quot;);
DbDestination&lt;MyRow&gt; dest = new DbDestination&lt;MyRow&gt;(connMan, &quot;DestinationTable&quot;);
</code></pre>
<p>If your table has the columns Id and/or Value, the data of your flow will be written into this columns.</p>
<h3 id="column-mapping">Column Mapping</h3>
<p>Of course the properties in the object and the columns can differ - ETLBox will only load columns from a source where it can find the right property. If the data type is different,
ETLBox will try to automatically convert the data. If the names are different, you can use the attribute ColumnMap to define the matching columns name for a property.
In our example, we could replace the property Id with a property Key - in order to still read data from the Id column, we add the ColumnMap attribute. Also, if we change
the data type to string, ETLBox will automatically convert the integer values into a string.</p>
<pre><code class="lang-C#">[ColumnMap(&quot;Id&quot;)]
public string Key { get;set; }
</code></pre>
<h3 id="using-dynamic-objects">Using dynamic objects</h3>
<p>Of course you can also use the default implementation of the DbDestination to write data into a table.</p>
<pre><code class="lang-C#">SqlConnectionManager connMan = new SqlConnectionManager(&quot;Data Source=.;Integrated Security=SSPI;Initial Catalog=ETLBox;&quot;);
DbDestination dest = new DbDestination(connMan, &quot;DestinationTable&quot;);
</code></pre>
<p>Like with an object, the properties of the ExpandoObject are used to map the values to the right columns. Only if the ExpandoObject object has a property with the same name as the column in the destination table, data is written into this column.
Unfortunately, the Column mapping attributes are not working here.</p>
<h3 id="using-arrays">Using arrays</h3>
<p>You can also use the DbDestination with array.</p>
<pre><code class="lang-C#">SqlConnectionManager connMan = new SqlConnectionManager(&quot;Data Source=.;Integrated Security=SSPI;Initial Catalog=ETLBox;&quot;);
DbDestination&lt;string[]&gt; dest = new DbDestination&lt;string[]&gt;(connMan, &quot;DestinationTable&quot;);
</code></pre>
<p>The data is written into the columns in the same order as they are stored in the array. E.g., if your string array has three values, these values are stored into the first, second and third column of your destination table. If your destination table has more columns, these will be ignored. Identity columns (or auto increment / serial values) are ignored.</p>
<h3 id="batch-size">Batch Size</h3>
<p>By default, the DbDestination will create batches of data that then are inserted in whole into the database. This is faster than creating a single insert for each incoming row. So the DbDestination is a little bit different from the other destinations: It will always wait until it has received the full amount of rows needed for a batch, and then do the insert. The default batch size is 1000.
You can play around with the batch size to gain higher performance. 1000 rows per batch is a solid value for most operations.
If you encounter the issue that inserted the data into the destinations takes to long, try to reduce the batch size significantly.</p>
<h4 id="odbc-and-oledb-connections">Odbc and OleDb connections</h4>
<p>If you leave the default value for batch size set, it will be changed to 100 rows for Odbc and OleDb connections. As the connection here is much slower than &quot;native&quot; connections, and bulk inserts need to be translated into &quot;INSERT INTO&quot; statements, 100 rows per batch leads to a much better performance than 1000 rows.</p>
<h2 id="default-connectionmanager">Default ConnectionManager</h2>
<p>Every component or task related to a database operation needs to have a connection managers set in order
to connect to the right database. Sometimes it can be cumbersome to pass the same connection manager over and over
again. To avoid this, there is a static <code>ControlFlow</code> class that contains the property <code>DefaultDbConnection</code>.
If you define a connection manager here, this will always be used as a fallback value if no other connection manager property was defined.</p>
<pre><code>ControlFlow.DefaultDbConnection = new SqlConnectionManager(&quot;Data Source=.;Integrated Security=SSPI;Initial Catalog=ETLBox;&quot;);
//Now you can just create a DbSource like this
var source = new DbSource(&quot;SourceTable&quot;);
</code></pre>
<h3 id="connection-string-wrapper">Connection String wrapper</h3>
<p>When you create a new connection manager, you have the choice to either pass the connection string directly or you
create an adequate ConnectionString object from the connection string before you pass it to the connection manager.
The ConnectionString object does exist for every database type (e.g. for MySql it is <code>MySqlConnectionString</code>). The ConnectionString
wraps the raw database connection string into the appropriate ConnectionStringBuilder object and also offers some more
functionalities, e.g. like getting a connection string for the database storing system information.</p>
<pre><code class="lang-C#">SqlConnectionString etlboxConnString = new SqlConnectionString(&quot;Data Source=.;Integrated Security=SSPI;Initial Catalog=ETLBox;&quot;);
SqlConnectionString masterConnString = etlboxConnString.GetMasterConnection();

//masterConnString is equal to &quot;Data Source=.;Integrated Security=SSPI;&quot;
SqlConnectionManager conectionToMaster = new SqlConnectionManager(masterConnString); 
</code></pre>
<h4 id="odbc-connections">ODBC Connections</h4>
<p>The <code>DbSource</code> and <code>DbDestination</code> also works with ODBC connection. Currently ODBC connections with Sql Server and Access are supported.
You will still use the underlying ADO.NET, but it allows you to connect to SQL Server or Access databases via ODBC.</p>
<p>Here is how you can connect via ODBC:</p>
<pre><code class="lang-C#">DbSource source = DbSource (
    new SqlODBCConnectionManager(&quot;Driver={SQL Server};Server=.;Database=ETLBox_ControlFlow;Trusted_Connection=Yes&quot;),
    &quot;SourceTable&quot;
);
</code></pre>
<p><em>Warning</em>: ODBC does not support bulk inserts like in &quot;native&quot; connections.
The <code>DbDestination</code> will do a bulk insert by creating a sql insert statement that
has multiple values: INSERT INTO (..) VALUES (..),(..),(..)</p>
<h4 id="access-db-connections">Access DB Connections</h4>
<p>The ODBC connection to Microsoft Access databases have more restrictions. ETLBox is based .NET Core and will run in your application as dependency.
It now depends if you compile your application with 32bit or 64bit (some version of .NET Core only support 64bit). You will need
the right Microsoft Access driver installed - either 32bit or 64bit. You can only install the 32bit driver
if you have a 32bit Access installed, and vice versa. Also, make sure to set up the correct ODBC connection (again, there is
64bit ODBC connection manager tool in windows and a 32bit).</p>
<p>The corresponding 64bit ODBC driver for Access can be download
Microsoft: <a href="https://www.microsoft.com/en-us/download/details.aspx?id=13255">Microsoft Access Database Engine 2010 Redistributable</a></p>
<p>To create a connection to an Access Database, use the <code>AccessOdbcConnectionManager</code> and an <code>OdbcConnectionString</code>.</p>
<pre><code class="lang-C#">DbDestination dest = DbDestination (
    new AccessOdbcConnectionManager(new OdbcConnectionString(&quot;Driver={Microsoft Access Driver (*.mdb, *.accdb)}DBQ=C:\DB\Test.mdb&quot;)),
    &quot;DestinationTable&quot;
);
</code></pre>
<p><em>Warning</em>: The <code>DbDestination</code> will do a bulk insert by creating a sql statement using a sql query that Access understands. The number of rows per batch is
very limited - if it too high, you will the error message 'Query to complex'. Try to reduce the batch size to solve this.</p>
<p><em>Note</em>: Please note that the AccessOdbcConnectionManager will create a &quot;temporary&quot; dummy table containing one record in your database when doing the bulk insert. After completion it will delete the table again.
This is necessary to simulate a bulk insert with Access-like Sql.</p>
<h3 id="generic-odbc-and-oledb-conenctions">Generic Odbc and OleDb conenctions</h3>
<p>As ETLBox has some database specific code in different components, you normally would choose an Odbc or OleDb connector that fits to your database.</p>
<p>But if your database is not supported yet, you can use the generic Odbc or OleDb connection manager to connection with <em>any</em> database.
Make sure you reference the Odbc or OleDb connector package.</p>
<ul>
<li><a href="https://www.nuget.org/packages/ETLBox.OleDb">OleDb connector package for ETLBox</a></li>
<li><a href="https://www.nuget.org/packages/ETLBox.Odbc">Odbc connector package for ETLBox</a></li>
</ul>
<p>Unfortunately, this connector will have some limitations.</p>
<ul>
<li>if you use DbDestination or DbSource with this connector, you would need to pass a TableDefinition object. This object basically holds the table name and column names, because they can't be automatically extracted from the database.</li>
<li>some ControlFlow components won't work (e.g. IfTableExistsTask). But SqlTask will work with the generic connection manager</li>
<li>if you use special characters in your table or columns names, you need to set the quotation begin / quotation end properties QB &amp; QE that fit to your database (e.g. &quot;[&quot; and &quot;]&quot; for Sql Server or &quot;`&quot; for MySql)</li>
</ul>
<h4 id="example-with-sqlserver-olddb">Example with SqlServer OldDb</h4>
<p>E.g. you can use the generic OleDb connection manager to connect with Sql Server via OleDb</p>
<p>You will need an OleDb connection string,.</p>
<pre><code class="lang-C#">var connString = @&quot;Provider=MSOLEDBSQL;Server=10.211.55.2;Database=ETLBox_DataFlow;UID=sa;PWD=YourStrong@Passw0rd;&quot;
OleDbConnectionManager conn = new OleDbConnectionManager(connString);
conn.QB = &quot;[&quot;; conn.QE = &quot;[&quot;; //not always needed, only for special characters
SqlTask.ExecuteNonQuery(conn, , &quot;INSERT INTO...&quot;);
</code></pre>
<p>You can also use this connection manager with the DbSource or the DbDestination component. But please note that this will only work if you pass the TableDefinition manually, like this:</p>
<pre><code class="lang-C#">var cols = new List&lt;TableColumn&gt;() {
                new TableColumn(&quot;Col1&quot;, &quot;INT&quot;, allowNulls: false),
                new TableColumn(&quot;Col2&quot;, &quot;VARCHAR(100)&quot;, allowNulls: true)
};
_sourcedef = new TableDefinition(&quot;TestTable&quot;, cols);
DbSource&lt;MySimpleRow&gt; source = new DbSource&lt;MySimpleRow&gt;(conn)
 {
     SourceTableDefinition = _sourcedef
};
</code></pre>
<p>Same for DbDestination - the property name is <code>DestinationTableDefinition</code> there.</p>
<h3 id="connection-pooling">Connection Pooling</h3>
<p>The implementation of all connection managers is based on Microsoft ADO.NET and makes use of the underlying
connection pooling. <a href="https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql-server-connection-pooling">Please see here for more details of connection pooling.</a>
This means that this actually can increase your performance, and in most scenarios you never have more
connections open that you actually need for your application.</p>
<p>You don't need to explicitly open a connection. ETLBox will call the <code>Open()</code> method on a connection manager whenever
needed - where it relies on the underlying ADO.NET connection pooling that either creates a new connection
or re-uses an existing one. Whenever the work of a component or task is done, the connection manager will return the connection back to
the pool so that it can be reused by other components or tasks when needed.</p>
<p>Please note that the connection pooling only works for the same connection strings. For every connection string that differs there
is going to be a separate pool</p>
<p>This behavior - returning connections back to the pool when the work is done - does work very well in a scenario
with concurrent tasks. There may be a use-case where you don't won't to query your database in parallel and you
want to leave the connection open, avoiding the pooling. <a href="https://github.com/etlbox/etlbox/issues/39">For this scenario you can use the <code>LeaveOpen</code> property
on the connection managers.</a></p>
<h3 id="table-definitions">Table Definitions</h3>
<p>If you pass a table name to a <code>DBsource</code> or <code>DbDestination</code> or a Sql statement to a <code>DbSource</code>, the meta data
of the table is automatically derived from that table or sql statement by ETLBox. For table or views this is done via a Sql statement that queries
system information, and for the Sql statement this is done via parsing the statement.
If you don't want ETLBox to read this information, or if you want to provide your own meta information,
you can pass a <code>TableDefinition</code> instead.</p>
<p>This could look like this:</p>
<pre><code>var TableDefinition = new TableDefinition(&quot;tableName&quot;
    , new List&lt;TableColumn&gt;() {
    new TableColumn(&quot;Id&quot;, &quot;BIGINT&quot;, allowNulls:false,  isPrimaryKey: true, isIdentity:true)),
    new TableColumn(&quot;OtherCol&quot;, &quot;NVARCHAR(100)&quot;, allowNulls: true)
});

var DbSource&lt;type&gt; = new DbSource&lt;type&gt;() {  
  SourceTableDefinition = TableDefinition
}
</code></pre>
<p>ETLBox will use this meta data instead to get the right column names.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Crafted with &lt;3 in Berlin<br>
<a href="https://etlbox.net/articles/legals.html">Contact & legal notice</a></span>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
